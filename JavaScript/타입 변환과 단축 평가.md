---
title: 타입 변환과 단축 평가
date: 2020-11-20 21:25:10
categories:
  - js
tags:
  - js
---

# 타입 변환과 단축 평가

## 타입 변환이란?
- 자바스크립트의 모든 값은 타입이 있다. 값의 타입은 개발자의 의도에 따라 다른 타입으로 변환할 수 있다. 개발자가 의도적으로 값의 타입을 변환하는 것을 명시적 타입 변환(explicit coercion) 또는 타입 캐스팅(type casting)이라 한다.

- 개발자의 의도와는 상관없이 표현식을 평가하는 도중에 자바스크립트 엔진에 의해 암묵적으로 타입이 자동 변환되기도 한다. 이를 암묵적 타입 변환(implicit coercion)또는 타입 강제 변환(type coercion)이라고 한다.

- 명시적 타입 변환이나 암묵적 타입 변환은 기존 원시값을 직접 변경하는것은 아니다. 원시값은 말 그대로 변경 불가능한 불변의 값이므로 변경할 수 없다. 타입 변환이란 기존 원시값을 사용하여 다른 타입의 새로운 원시값을 생성하는 것이다.


## 암묵적 타입 변환
- 자바스크립트 엔진은 표현식을 평가할 때 개발자의 의도와는 상관없이 코드의 문맥을 고려해 암묵적으로 데이터 타입을 강제 변환(암묵적 타입 변환)할 때가 있다.

## 명시적 타입 변환
- 개발자의 의도에 따라 명시적으로 타입을 변경하는 방법은 다양하다. 표준 빌트인 생성자 함수(String, Number, Boolean)를 new 연산자 없이 호출하는 방법과 빌트인 메서드 사용하는 방법이 있다.

## 단축 평가

### 논리 연산자를 사용한 단축 평가
- OR(||)연산자와 AND(&&)연산자 표현식의 평가 결과는 불리언 값이 아닐 수도 있다. OR, AND연산자 표현식은 언제나 2개의 피연산자 중 어느 한쪽으로 평가된다.

### AND연산자
```js
'first' && 'second' // -> 'second'
```
- AND연산자는 두 개의 피 연산자가 모두 true로 평가될때 true를 반환한다. 그때 순서는 좌항에서 우항으로 평가가 진행이 되는데 위와 같은 경우는 암묵적 형변환으로 'first'가 true값으로 평가됐더라도 우항의 값도 확인돼야 위 표현식을 평가할 수 있다. 이때 AND연산의 반환값은 우항(두번째)의 피연산자 'second'를 반환하게 된다.

- 반대로 좌항(첫번째)의 피연산자가 만약 null이나 undefined등의 false값으로 평가되는 피연산자라면 AND연산자는 좌항이 false일때 우항을 굳이 읽지 않기때문에 좌항의 피연산자를 반환한다.

### OR연산자
```js
'first' || 'second' // -> 'first'
```

- OR연산자는 두 개의 피연산자 중 하나라도 true로 평가될때 true를 반환한다. 순서는 동일하게 좌항에서 우항으로 평가되고 좌항(첫번째)의 피 연산자가 true일 경우 굳이 읽지 않기때문에 좌항(첫번쨰)의 피 연산자를 반환한다.

- 반대로 좌항의 피연산자가 null이나 undefined처럼 false값으로 평가되는 피연산자여도 우항(두번째)의 피연산자가 값을 확인해야 되기 때문에 이럴땐 우항(두번째)의 피연산자를 반환한다.

## 옵셔널 체이닝 연산자
- ES11(ECMAScript2020)에서 도입된 옵셔널 체이닝 연산자`?.`는 좌항의 피연산자가 null 또는 undefined인 경우 undefined를 반환하고, 그렇지 않으면 우항의 프로퍼티 참조를 이어간다.

- AND(&&)연산으로 단축평가를 하게되면 좌항의 값이 false로 평가되는 값이면 좌항의 피연산자로 평가되고 좌항의 값이 true로 평가되는 값이면 우항의 피연산자로 평가되는데 옵셔널 체이닝 연산자는 좌항의 연산자가 단순히 false로 평가되는 값이 아닌 null과 undefined만 false값으로 평가하고 그 이외에는 우항의 프로퍼티를 참조한다.
```js
var str = '';
var length = str?.length; // -> 0
```

## null 병합 연산자
- ES11에서 도입된 null병합 연산자`??`는 좌항의 피연산자가 null 또는 undefined인 경우 우항의 피연산자를 반환하고 그렇지 않으면 좌항의 피연산자를 반환한다.

- null병합 연산자는 변수에 기본값을 설정할 때 유용하다. null병합 연산자가 도입되기 이전에는 OR연산자`||`를 사용한 단축 평가를 통해 변수에 기본값을 설정했다. OR연산자를 사용한 단축 평가의 경우 좌항의 피연산자가 false로 평가되는 값이면 우항의 피연산자를 반환한다. 만약 false로 평가되는 값인 0이나 ''도 기본값으로써 유효하다면 예기치 않은 동작이 발생할 수 있다.
```js
var default = '' || 'default string';
console.log(default); // -> 'default string'
```

- 하지만 null병합 연산자`??`는 좌항의 피연산자가 false로 평가되는 값이라도 null아나 undefined가 아니라면 좌항의 피연산자를 그대로 반환한다.
```js
var default = '' ?? 'default string';
console.log(default); // -> ''
```
